### salsa20_encrypt_decrypt_plugin
==============================

This plugin is created for encryption and decryption using [Salsa20](https://en.wikipedia.org/wiki/Salsa20) in MariaDB.

Please make sure to properly test and adapt it to your environment before using it in a production setting.


Disclaimer
----------

This code may pose risks such as data loss depending on your environment.

Author disclaim any express or implied warranties regarding the accuracy, completeness, reliability, or suitability for a particular purpose of this code.

It is the user's responsibility to ensure that this code is appropriate and secure for their application.

If you do not agree, do not use this code.


Required libraries
------------------

The following libraries are required for building: `libsodium`, `libmysqlclient`.

- Ubuntu/Debian
  
  sudo apt-get update
  sudo apt-get install libmysqlclient-dev libsodium-dev

- CentOS/RHEL
  
  sudo yum install mysql-devel libsodium-devel


How to build
------------

make


### How to install
--------------

1. Copy the built `salsa20_encrypt_decrypt_plugin.so` file to the MariaDB plugin directory.
   
   sudo cp ./salsa20_encrypt_decrypt_plugin.so /path/to/your/mysql/plugin/directory/

2. Map the library with the function creation query.
   
   CREATE FUNCTION SALSA_ENCRYPT RETURNS STRING SONAME 'salsa20_encrypt_decrypt_plugin.so';
   CREATE FUNCTION SALSA_DECRYPT RETURNS STRING SONAME 'salsa20_encrypt_decrypt_plugin.so';

* Where is the MariaDB plugin directory
  You can find the plugin directory by executing the following query:
  `SHOW VARIABLES LIKE 'plugin_dir';`

  The output should look similar to this:
  +---------------+----------------------------------+
  | Variable_name | Value                            |
  +---------------+----------------------------------+
  | plugin_dir    | /usr/share/lib64/mysql/plugin/   |
  +---------------+----------------------------------+

How to use
----------

You can use it as follows:

-- INSERT
INSERT INTO tb_messages(message) VALUES( SALSA_ENCRYPT("KEY", "MESSAGE") );

-- SELECT ... WHERE
SELECT SALSA_DECRYPT("KEY", message) AS "message" FROM tb_messages WHERE SALSA_DECRYPT("KEY", message) LIKE "%something%";


License
-------

Unlicense